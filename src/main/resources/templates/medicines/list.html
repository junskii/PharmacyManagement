<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Medicine Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div th:replace="fragments/navbar :: navbar"></div>
    <div class="container mt-4" style="padding-top: 60px;">
        <h2 class="mb-4">Medicine Management</h2>
        <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>
        <div th:if="${canManage}" class="mb-3">
            <a th:href="@{/medicines/add}" class="btn btn-success">Add Medicine</a>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Stock</th>
                        <th>Price</th>
                        <th>Description</th>
                        <th>Image</th>
                        <th>Expired Date</th>
                        <th>Created At</th>
                        <th th:if="${canManage}">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:if="${medicines.size()} == 0">
                        <td colspan="9" class="text-center">No medicine data available.</td>
                    </tr>
                    <tr th:each="medicine : ${medicines}">
                        <td th:text="${medicine.id}"></td>
                        <td th:text="${medicine.name}"></td>
                        <td th:text="${medicine.stock}"></td>
                        <td th:text="${medicine.price}"></td>
                        <td th:text="${medicine.description}"></td>
                        <td>
                            <img th:if="${medicine.image}" th:src="@{${medicine.image}}" alt="Image"
                                style="max-width:60px;max-height:60px;">
                        </td>
                        <td th:text="${#temporals.format(medicine.expiryDate, 'yyyy-MM-dd')}"></td>
                        <td th:text="${#dates.format(medicine.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                        <td th:if="${canManage}">
                            <a th:href="@{/medicines/edit/{id}(id=${medicine.id})}"
                                class="btn btn-sm btn-warning">Edit</a>
                            <a th:href="@{/medicines/delete/{id}(id=${medicine.id})}" class="btn btn-sm btn-danger"
                                onclick="return confirm('Are you sure to delete?')">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <a href="/dashboard" class="btn btn-secondary mt-3">Back to Dashboard</a>
    </div>
</body>

</html>